:root{
  --bg:#0f1724;
  --card:#111827;
  --muted:#9ca3af;
  --accent:#60a5fa;
  --accent-2:#cf8fcb;
  --success:#4ade80;
  --warning:#fbbf24;
  --danger:#f87171;
}

*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html{scroll-behavior:smooth}

body {
  --background-color: #1a1d24;
  --primary-text-color: #e5e9f0;
  --secondary-text-color: #d8dee9;
  --accent-color: #88c0d0;
  --accent-color-hover: #8fbcbb;
  --surface-color: #2a2f3a;
  --surface-color-elevated: #353b48;
  --border-color: #3d4450;
  --box-shadow-color: rgba(0, 0, 0, 0.25);

  --font-family-main: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
  --line-height-normal: 1.5;
  --header-height: 70px;

  color-scheme: dark;
  font-family: var(--font-family-main);
  line-height: var(--line-height-normal);
  margin: 40px 0 0 0;
  padding: 12px 12px calc(env(safe-area-inset-bottom) + var(--header-height) + 16px) 12px;
  background-color: var(--background-color);
  color: var(--primary-text-color);
  -webkit-overflow-scrolling: touch;
  min-height: 100vh;
  font-size: 15px;
}

/* Force Dark Mode Colors */
.asset { color: #4ade80; }
.liability { color: #f87171; }
.positive-amount { color: #4ade80; }

/* Container */
.container{margin:0 auto;padding:0;max-width:1200px}

/* Header/Top Section */
.top{display:none}
.balances{display:none}

/* Lists Grid */
.lists{
  display:grid;
  grid-template-columns:1fr;
  gap:16px;
}

@media (min-width:768px){
  .lists{grid-template-columns:repeat(2,1fr)}
}
@media (min-width:1024px){
  .lists{grid-template-columns:repeat(4,1fr)}
}

/* Section Cards */
.list{
  background:var(--surface-color);
  padding:16px;
  border-radius:16px;
  box-shadow:0 2px 8px var(--box-shadow-color);
}

.list h2{
  margin:0 0 12px 0;
  display:flex;
  align-items:center;
  justify-content:space-between;
  font-size:18px;
  font-weight:700;
  letter-spacing:-0.02em;
}

.section-total{
  font-size:15px;
  font-weight:600;
  color:var(--muted);
  margin-left:auto;
  margin-right:8px;
}

.list h2 .addItemSectionBtn{
  background:var(--surface-color-elevated);
  border:1px solid var(--border-color);
  color:var(--muted);
  width:36px;
  height:36px;
  border-radius:10px;
  cursor:pointer;
  font-size:20px;
  font-weight:500;
  display:flex;
  align-items:center;
  justify-content:center;
  transition:transform 0.15s ease, background 0.15s ease;
  flex-shrink:0;
}

.list h2 .addItemSectionBtn:active{
  transform:scale(0.92);
  background:var(--border-color);
}

/* Last Action Banner */
.last-action {
  font-size: 12px;
  color: var(--muted);
  padding: 8px 12px;
  margin: -4px -4px 12px -4px;
  background: var(--surface-color-elevated);
  border-radius: 8px;
  opacity: 0.8;
}

/* Item Cards */
.item{
  display:flex;
  flex-direction:row; /* Changed to row for inline actions */
  align-items: center;
  gap:12px;
  padding:12px 14px;
  border-radius:12px;
  background:var(--surface-color-elevated);
  margin-bottom:10px;
  transition:transform 0.12s ease;
  position:relative;
  overflow:hidden;
}

/* The clickable content area (info + meta) */
.item .item-content {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 6px;
  min-width: 0;
  cursor: pointer;
}

.item:active{
  /* transform:scale(0.98); -- moved to buttons or specific interaction */
}

.item .item-info {
  display:flex;
  flex-wrap:nowrap;
  align-items:center;
  justify-content: space-between;
  gap:8px;
}

.item .item-name {
  font-weight:600;
  font-size:16px;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
  color: var(--primary-text-color);
}

.item .item-amount {
  font-size:16px;
  font-weight:700;
  white-space:nowrap;
}

.item .item-meta-row {
  width:100%;
  display:flex;
  align-items:center;
  gap:8px;
}

.item .meta{
  color:var(--muted);
  font-size:12px;
  line-height:1.3;
}

/* Actions Container */
.item .item-actions-inline {
  display:flex;
  align-items:center;
  gap:8px;
  flex-shrink: 0;
}

/* Action Buttons */
.icon-action-btn {
  background: var(--surface-color);
  border: 1px solid var(--border-color);
  color: var(--primary-text-color);
  width: 36px;
  height: 36px;
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
  cursor: pointer;
  transition: all 0.2s ease;
  padding: 0;
}

.icon-action-btn:hover {
  background: var(--border-color);
}

.icon-action-btn:active {
  transform: scale(0.92);
  background: var(--accent-color);
  border-color: var(--accent-color);
  color: #fff;
}

.icon-action-btn.edit {
  color: var(--muted);
}

/* Progress Bar */
.item-progress {
  width:100%;
  height:4px;
  background:rgba(255,255,255,0.05);
  border-radius:2px;
  overflow:hidden;
  margin-top:2px;
}

.item-progress-bar {
  height:100%;
  border-radius:2px;
  transition:width 0.3s ease;
}

.item-progress-bar.good { background: var(--success); }
.item-progress-bar.warning { background: var(--warning); }
.item-progress-bar.danger { background: var(--danger); }

/* Modal Styles */
.modal-overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.5);
  display:flex;
  align-items:flex-start;
  justify-content:center;
  z-index:9999;
  padding:0;
  padding-top:env(safe-area-inset-top);
  animation:fadeIn 0.2s ease;
}

@keyframes fadeIn {
  from { opacity:0; }
  to { opacity:1; }
}

@keyframes slideDown {
  from { transform:translateY(-100%); }
  to { transform:translateY(0); }
}

.modal{
  background:var(--surface-color);
  padding:20px;
  padding-top:calc(20px + env(safe-area-inset-top));
  border-radius:0 0 20px 20px;
  width:100%;
  max-width:500px;
  max-height:90vh;
  overflow-y:auto;
  color:inherit;
  box-shadow:0 4px 30px rgba(0,0,0,0.3);
  animation:slideDown 0.25s ease;
}

@media (min-width:600px){
  .modal-overlay{
    align-items:center;
    padding:20px;
    padding-top:20px;
  }
  .modal{
    border-radius:20px;
    padding-top:20px;
    padding-bottom:20px;
    max-height:calc(100vh - 40px);
    animation:slideUp 0.25s ease;
  }
  @keyframes slideUp {
    from { transform:translateY(20px); opacity:0; }
    to { transform:translateY(0); opacity:1; }
  }
}

.modal h3{
  margin:0 0 16px 0;
  font-size:22px;
  font-weight:700;
  letter-spacing:-0.02em;
}

.modal label{
  display:block;
  margin-bottom:14px;
  font-size:15px;
  font-weight:500;
  color:var(--muted);
}

.modal label.toggle-label{
  display:flex;
  align-items:center;
  gap:10px;
  padding:12px 16px;
  background:var(--surface-color-elevated);
  border-radius:12px;
  border:2px solid var(--border-color);
  cursor:pointer;
  color:var(--primary-text-color);
}

.modal label.toggle-label input[type="checkbox"]{
  width:20px;
  height:20px;
  accent-color:var(--accent-color);
}

.modal input[type="text"],
.modal input[type="number"],
.modal input[type="date"],
.modal select{
  width:100%;
  padding:14px 16px;
  border-radius:12px;
  border:2px solid var(--border-color);
  background:var(--surface-color-elevated);
  color:inherit;
  font-size:17px;
  margin-top:6px;
  transition:border-color 0.15s ease;
}

.modal input:focus,
.modal select:focus{
  outline:none;
  border-color:var(--accent-color);
}

.modal .actions{
  display:flex;
  justify-content:flex-end;
  gap:10px;
  margin-top:20px;
}

.modal .actions button{
  padding:14px 24px;
  border-radius:12px;
  border:none;
  cursor:pointer;
  font-size:16px;
  font-weight:600;
  min-height:48px;
  transition:transform 0.12s ease, background 0.12s ease;
}

.modal .actions button:active{
  transform:scale(0.96);
}

.modal .actions button#_item_ok,
.modal .actions button#_spend_ok{
  background:var(--accent-color);
  color:#fff;
  flex:1;
}

.modal .actions button#_item_cancel,
.modal .actions button#_spend_cancel{
  background:var(--surface-color-elevated);
  color:var(--primary-text-color);
}

.modal .actions button.delBtn{
  background:#dc2626;
  color:#fff;
}

/* Gist Controls in Modal */
.gist-controls{
  display:flex;
  flex-direction:column;
  gap:12px;
}

.gist-controls input{
  padding:14px 16px;
  border-radius:12px;
  border:2px solid var(--border-color);
  background:var(--surface-color-elevated);
  color:inherit;
  font-size:16px;
}

.gist-buttons{
  display:flex;
  gap:10px;
}

.gist-buttons button{
  flex:1;
  padding:14px;
  border-radius:12px;
  border:none;
  background:var(--accent-2);
  color:#fff;
  cursor:pointer;
  font-weight:600;
  font-size:15px;
  min-height:48px;
  transition:transform 0.12s ease;
}

.gist-buttons button:active{
  transform:scale(0.96);
}

.status{
  font-size:14px;
  color:var(--muted);
  text-align:center;
  padding:8px;
}

/* Backup Section */
.backup-section{
  margin-top:20px;
  padding-top:20px;
  border-top:1px solid var(--border-color);
  display:flex;
  flex-direction:column;
  gap:10px;
}

.backup-section h4{
  margin:0;
  font-size:15px;
  font-weight:600;
  color:var(--primary-text-color);
}

.backup-buttons{
  display:flex;
  gap:10px;
}

.backup-btn{
  flex:1;
  padding:12px 16px;
  border-radius:10px;
  border:1px solid var(--border-color);
  background:var(--surface-color-elevated);
  color:var(--primary-text-color);
  cursor:pointer;
  font-weight:500;
  font-size:14px;
  min-height:44px;
  transition:transform 0.12s ease, background 0.12s ease;
}

.backup-btn:hover{
  background:var(--border-color);
}

.backup-btn:active{
  transform:scale(0.97);
}

.backup-section small{
  color:var(--muted);
  font-size:12px;
  text-align:center;
}

/* Install App Section */
.install-app-section{
  margin-top:16px;
  padding-top:16px;
  border-top:1px solid var(--border-color);
  display:flex;
  flex-direction:column;
  gap:8px;
}

.install-app-section small{
  color:var(--muted);
  font-size:12px;
  text-align:center;
}

/* Update Section */
.update-section{
  margin-top:16px;
  padding-top:16px;
  border-top:1px solid var(--border-color);
  display:flex;
  flex-direction:column;
  gap:8px;
}

.update-section small{
  color:var(--muted);
  font-size:13px;
  text-align:center;
}

.update-btn{
  padding:14px 20px;
  border-radius:12px;
  border:none;
  background:var(--surface-color-elevated);
  color:var(--primary-text-color);
  cursor:pointer;
  font-weight:600;
  font-size:15px;
  min-height:48px;
  transition:transform 0.12s ease, background 0.12s ease;
}

.update-btn:active{
  transform:scale(0.96);
}

.update-btn:disabled{
  opacity:0.5;
  cursor:not-allowed;
}

/* Footer Bar */
.footer-bar {
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:12px 16px calc(12px + env(safe-area-inset-bottom)) 16px;
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  z-index:999;
  background:var(--surface-color);
  box-shadow:0 -2px 20px var(--box-shadow-color);
  border-top:1px solid var(--border-color);
  -webkit-user-select:none;
  user-select:none;
}

.footer-left {
  display:flex;
  flex-direction:column;
  gap:2px;
}

.available-amount{
  display:flex;
  flex-direction:column;
  align-items:flex-start;
}

.available-amount #available{
  font-weight:800;
  font-size:28px;
  color:var(--success);
  line-height:1.1;
}

.available-label{
  font-size:12px;
  color:var(--muted);
  text-transform:uppercase;
  letter-spacing:0.05em;
  font-weight:500;
}

.footer-right {
  display:flex;
  align-items:center;
  gap:8px;
}

.icon-btn {
  appearance:none;
  border:none;
  background:var(--surface-color-elevated);
  color:var(--primary-text-color);
  font-weight:600;
  font-size:18px;
  border-radius:10px;
  padding:12px;
  min-width:44px;
  min-height:44px;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  transition:transform 0.12s ease, background 0.12s ease;
  cursor:pointer;
}

.icon-btn:active {
  transform:scale(0.95);
  background:var(--border-color);
}

/* Checkbox styling */
.modal input[type="checkbox"] {
  width:24px;
  height:24px;
  margin-right:8px;
  accent-color:var(--accent-color);
}

/* Spend history in modal */
.modal h4 {
  font-size:16px;
  font-weight:600;
  margin:16px 0 8px 0;
  color:var(--muted);
}

.modal ul {
  margin:0;
  padding:0;
  font-size:14px;
  color:var(--secondary-text-color);
  list-style:none;
}

.modal ul.spend-history-list li {
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:8px;
  padding:10px 12px;
  border-bottom:1px solid var(--border-color);
  background:var(--surface-color-elevated);
  border-radius:8px;
  margin-bottom:6px;
}

.modal ul.spend-history-list li:last-child {
  border-bottom:none;
  margin-bottom:0;
}

.modal ul.spend-history-list .spend-info {
  flex:1;
  min-width:0;
  overflow:hidden;
  text-overflow:ellipsis;
}

.modal ul.spend-history-list .delete-spend-btn {
  background:transparent;
  border:none;
  color:var(--danger-color, #ef4444);
  cursor:pointer;
  font-size:14px;
  padding:6px 10px;
  border-radius:6px;
  transition:background 0.15s ease;
  flex-shrink:0;
}

.modal ul.spend-history-list .delete-spend-btn:hover {
  background:rgba(239, 68, 68, 0.15);
}

.modal ul.spend-history-list .delete-spend-btn:active {
  background:rgba(239, 68, 68, 0.25);
}

.modal small {
  display:block;
  font-size:13px;
  color:var(--muted);
  line-height:1.5;
  margin-top:12px;
}

/* Empty state */
.list-items:empty::after {
  content:'No items yet';
  display:block;
  text-align:center;
  color:var(--muted);
  font-size:14px;
  padding:20px;
  opacity:0.6;
}

/* Touch feedback for items */
@media (hover:none) {
  .item:active {
    background:var(--border-color);
  }
}

/* Smooth scrolling for iOS */
.list-items {
  -webkit-overflow-scrolling:touch;
}

/* Hide scrollbars but keep functionality */
.modal::-webkit-scrollbar,
.list-items::-webkit-scrollbar {
  width:0;
  height:0;
}

/* Install Instructions Modal */
.install-instructions {
  display:flex;
  flex-direction:column;
  gap:16px;
  margin:16px 0;
}

.install-method {
  background:var(--surface-color);
  border-radius:10px;
  padding:14px;
}

.install-method h4 {
  margin:0 0 10px 0;
  font-size:14px;
  font-weight:600;
  color:var(--accent-color);
}

.install-method ol {
  margin:0;
  padding-left:20px;
}

.install-method li {
  font-size:13px;
  color:var(--secondary-text-color);
  margin-bottom:6px;
  line-height:1.4;
}

.install-method li:last-child {
  margin-bottom:0;
}

.install-method li strong {
  color:var(--primary-text-color);
}

.install-note {
  font-size:12px;
  color:var(--muted);
  text-align:center;
  margin:12px 0 0 0;
  padding:12px;
  background:var(--surface-color);
  border-radius:8px;
}
